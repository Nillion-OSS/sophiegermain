"""
Pure-Python library that provides a selection of Sophie Germain primes.
"""
from __future__ import annotations
import doctest

_DATA = [
    2,
    5,
    11,
    23,
    41,
    83,
    131,
    281,
    593,
    1031,
    2063,
    4211,
    8243,
    16421,
    32771,
    65633,
    131321,
    262193,
    524351,
    1048889,
    2097629,
    4194581,
    8388953,
    16777259,
    33554771,
    67108913,
    134218433,
    268435631,
    536871311,
    1073741891,
    2147483693,
    4294967681,
    8589934631,
    17179869659,
    34359738701,
    68719477223,
    137438954063,
    274877907599,
    549755814221,
    1099511627933,
    2199023256029,
    4398046511483,
    8796093023213,
    17592186049073,
    35184372090953,
    70368744178451,
    140737488355781,
    281474976711419,
    562949953423283,
    1125899906843669,
    2251799813686211,
    4503599627370533,
    9007199254741931,
    18014398509485351,
    36028797018965483,
    72057594037930223,
    144115188075860453,
    288230376151712453,
    576460752303424853,
    1152921504606849959,
    2305843009213697249,
    4611686018427389243,
    9223372036854777359,
    18446744073709552109,
    36893488147419109379,
    73786976294838207473,
    147573952589676413429,
    295147905179352827039,
    590295810358705651829,
    1180591620717411304553,
    2361183241434822608669,
    4722366482869645217633,
    9444732965739290427683,
    18889465931478580854821,
    37778931862957161712463,
    75557863725914323420571,
    151115727451828646838329,
    302231454903657293676719,
    604462909807314587354183,
    1208925819614629174707521,
    2417851639229258349412871,
    4835703278458516698825341,
    9671406556917033397651433,
    19342813113834066795305219,
    38685626227668133590607079,
    77371252455336267181202381,
    154742504910672534362395373,
    309485009821345068724782539,
    618970019642690137449563171,
    1237940039285380274899129853,
    2475880078570760549798248679,
    4951760157141521099596501601,
    9903520314283042199193000359,
    19807040628566084398385994563,
    39614081257132168796771976611,
    79228162514264337593543956823,
    158456325028528675187087901683,
    316912650057057350374175806433,
    633825300114114700748351608643,
    1267650600228229401496703206331,
    2535301200456458802993406417403,
    5070602400912917605986812835131,
    10141204801825835211973625644709,
    20282409603651670423947251286503,
    40564819207303340847894502575599,
    81129638414606681695789005145439,
    162259276829213363391578010293519,
    324518553658426726783156020581003,
    649037107316853453566312041155083,
    1298074214633706907132624082307923,
    2596148429267413814265248164620191,
    5192296858534827628530496329221303,
    10384593717069655257060992658447431,
    20769187434139310514121985316888389,
    41538374868278621028243970633779923,
    83076749736557242056487941267521963,
    166153499473114484112975882535050719,
    332306998946228968225951765070090999,
    664613997892457936451903530140177493,
    1329227995784915872903807060280346971,
    2658455991569831745807614120560695413,
    5316911983139663491615228241121381713,
    10633823966279326983230456482242769583,
    21267647932558653966460912964485517069,
    42535295865117307932921825928971026843,
    85070591730234615865843651857942057263,
    170141183460469231731687303715884111953,
    340282366920938463463374607431768219863,
    680564733841876926926749214863536425363,
    1361129467683753853853498429727072846803,
    2722258935367507707706996859454145700069,
    5444517870735015415413993718908291383453,
    10889035741470030830827987437816582769769,
    21778071482940061661655974875633165538621,
    43556142965880123323311949751266331069263,
    87112285931760246646623899502532662140501,
    174224571863520493293247799005065324273251,
    348449143727040986586495598010130648534839,
    696898287454081973172991196020261297063421,
    1393796574908163946345982392040522594127869,
    2787593149816327892691964784081045188258829,
    5575186299632655785383929568162090376508863,
    11150372599265311570767859136324180752993673,
    22300745198530623141535718272648361505983651,
    44601490397061246283071436545296723011976483,
    89202980794122492566142873090593446023927983,
    178405961588244985132285746181186892047846859,
    356811923176489970264571492362373784095702209,
    713623846352979940529142984724747568191374089,
    1427247692705959881058285969449495136382756861,
    2854495385411919762116571938898990272765495201,
    5708990770823839524233143877797980545530992191,
    11417981541647679048466287755595961091061979379,
    22835963083295358096932575511191922182123979213,
    45671926166590716193865151022383844364247901541,
    91343852333181432387730302044767688728495788053,
    182687704666362864775460604089535377456991591479,
    365375409332725729550921208179070754913983137071,
    730750818665451459101842416358141509827966329493,
    1461501637330902918203684832716283019655932553531,
    2923003274661805836407369665432566039311865088571,
    5846006549323611672814739330865132078623730180659,
    11692013098647223345629478661730264157247460345371,
    23384026197294446691258957323460528314494920700493,
    46768052394588893382517914646921056628989841393013,
    93536104789177786765035829293842113257979682754401,
    187072209578355573530071658587684226515959365503691,
    374144419156711147060143317175368453031918731015723,
    748288838313422294120286634350736906063837462027973,
    1496577676626844588240573268701473812127674924033903,
    2993155353253689176481146537402947624255349848026329,
    5986310706507378352962293074805895248510699696042981,
    11972621413014756705924586149611790497021399392064843,
    23945242826029513411849172299223580994042798784144939,
    47890485652059026823698344598447161988085597568266953,
    95780971304118053647396689196894323976171195136479403,
    191561942608236107294793378393788647952342390273013611,
    383123885216472214589586756787577295904684780545913379,
    766247770432944429179173513575154591809369561091801589,
    1532495540865888858358347027150309183618739122183605753,
    3064991081731777716716694054300618367237478244367232561,
    6129982163463555433433388108601236734474956488734416079,
    12259964326927110866866776217202473468949912977468821119,
    24519928653854221733733552434404946937899825954937637409,
    49039857307708443467467104868809893875799651909875275863,
    98079714615416886934934209737619787751599303819750542121,
    196159429230833773869868419475239575503198607639501080049,
    392318858461667547739736838950479151006397215279002176689,
    784637716923335095479473677900958302012794430558004317013,
    1569275433846670190958947355801916604025588861116008630589,
    3138550867693340381917894711603833208051177722232017264419,
    6277101735386680763835789423207666416102355444464034530021,
    12554203470773361527671578846415332832204710888928069026893,
    25108406941546723055343157692830665664409421777856138068283,
    50216813883093446110686315385661331328818843555712276106921,
    100433627766186892221372630771322662657637687111424552210921,
    200867255532373784442745261542645325315275374222849104414769,
    401734511064747568885490523085290650630550748445698208831021,
    803469022129495137770981046170581301261101496891396417742791,
    1606938044258990275541962092341162602522202993782792835304761,
    3213876088517980551083924184682325205044405987565585670606883,
    6427752177035961102167848369364650410088811975131171341206081,
    12855504354071922204335696738729300820177623950262342682426881,
    25711008708143844408671393477458601640355247900524685364835589,
    51422017416287688817342786954917203280710495801049370729649531,
    102844034832575377634685573909834406561420991602098741459293393,
    205688069665150755269371147819668813122841983204197482918591959,
    411376139330301510538742295639337626245683966408394965837154033,
    822752278660603021077484591278675252491367932816789931674307953,
    1645504557321206042154969182557350504982735865633579863348624211,
    3291009114642412084309938365114701009965471731267159726697282233,
    6582018229284824168619876730229402019930943462534319453394443453,
    13164036458569648337239753460458804039861886925068638906788875909,
    26328072917139296674479506920917608079723773850137277813577748591,
    52656145834278593348959013841835216159447547700274555627155506123,
    105312291668557186697918027683670432318895095400549111254311011449,
    210624583337114373395836055367340864637790190801098222508621958639,
    421249166674228746791672110734681729275580381602196445017243913631,
    842498333348457493583344221469363458551160763204392890034487835021,
    1684996666696914987166688442938726917102321526408785780068975651923,
    3369993333393829974333376885877453834204643052817571560137951281233,
    6739986666787659948666753771754907668409286105635143120275902562431,
    13479973333575319897333507543509815336818572211270286240551805128049,
    26959946667150639794667015087019630673637144422540572481103610259051,
    53919893334301279589334030174039261347274288845081144962207220503193,
    107839786668602559178668060348078522694548577690162289924414441007359,
    215679573337205118357336120696157045389097155380324579848828882001951,
    431359146674410236714672241392314090778194310760649159697657763995341,
    862718293348820473429344482784628181556388621521298319395315527975539,
    1725436586697640946858688965569256363112777243042596638790631055971743,
    3450873173395281893717377931138512726225554486085193277581262111925433,
    6901746346790563787434755862277025452451108972170386555162524223820243,
    13803492693581127574869511724554050904902217944340773110325048447633719,
    27606985387162255149739023449108101809804435888681546220650096895207373,
    55213970774324510299478046898216203619608871777363092441300193790465963,
    110427941548649020598956093796432407239217743554726184882600387580792433,
    220855883097298041197912187592864814478435487109452369765200775161583019,
    441711766194596082395824375185729628956870974218904739530401550323171253,
    883423532389192164791648750371459257913741948437809479060803100646332271,
    1766847064778384329583297500742918515827483896875618958121606201292630001,
    3533694129556768659166595001485837031654967793751237916243212402585247763,
    7067388259113537318333190002971674063309935587502475832486424805170494603,
    14134776518227074636666380005943348126619871175004951664972849610340959741,
    28269553036454149273332760011886696253239742350009903329945699220681938479,
    56539106072908298546665520023773392506479484700019806659891398441363833771,
    113078212145816597093331040047546785012958969400039613319782796882727676003,
    226156424291633194186662080095093570025917938800079226639565593765455337961,
    452312848583266388373324160190187140051835877600158453279131187530910665321,
    904625697166532776746648320380374280103671755200316906558262375061821345571,
    1809251394333065553493296640760748560207343510400633813116524750123642671019,
    3618502788666131106986593281521497120414687020801267626233049500247285305403,
    7237005577332262213973186563042994240829374041602535252466099000494570629089,
    14474011154664524427946373126085988481658748083205070504932198000989141205031,
    28948022309329048855892746252171976963317496166410141009864396001978282508223,
    57896044618658097711785492504343953926634992332820282019728792003956564935063,
    115792089237316195423570985008687907853269984665640564039457584007913129658411
]

def sophiegermain(bit_length: int) -> int:
    """
    Return the smallest Sophie Germain prime that can be represented using
    the specified number of bits.
    
    >>> sophiegermain(2)
    2
    >>> sophiegermain(8)
    131
    >>> sophiegermain(16)
    32771
    >>> sophiegermain(32)
    2147483693
    >>> sophiegermain(257)
    115792089237316195423570985008687907853269984665640564039457584007913129658411

    The result returned by :obj:`sophiegermain` can always be represented
    using the specified number of bits.
    
    >>> all([sophiegermain(k).bit_length() == k for k in range(2, 258)])
    True

    If a bit length outside the supported range is supplied, an
    exception is raised.

    >>> sophiegermain(-1)
    Traceback (most recent call last):
      ...
    ValueError: all Sophie Germain primes have bit lengths of at least 2
    >>> sophiegermain(1)
    Traceback (most recent call last):
      ...
    ValueError: all Sophie Germain primes have bit lengths of at least 2
    >>> sophiegermain(258)
    Traceback (most recent call last):
      ...
    ValueError: bit lengths greater than 257 are not supported

    The supplied bit length must be an integer.
    
    >>> sophiegermain('abc')
    Traceback (most recent call last):
      ...
    TypeError: bit length must be an integer
    """
    if not isinstance(bit_length, int):
        raise TypeError('bit length must be an integer')

    if bit_length < 2:
        raise ValueError(
            'all Sophie Germain primes have bit lengths of at least 2'
        )

    if bit_length > len(_DATA) + 1:
        raise ValueError(
            'bit lengths greater than ' + str(len(_DATA) + 1) + ' are not supported'
        )

    return _DATA[bit_length - 2]

if __name__ == '__main__':
    doctest.testmod() # pragma: no cover
